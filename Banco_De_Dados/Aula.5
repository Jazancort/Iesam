CREATE DATABASE ESTACIO;
CREATE TABLE tb_cargo (
id_cargo	integer,
ds_cargo	varchar(40) NOT NULL,
valor		numeric(15,2) NOT NULL,
fg_ativo	integer,
PRIMARY KEY (id_cargo));
Use ESTACIO;
ALTER TABLE tb_cargo MODIFY ds_cargo varchar(40);

INSERT INTO tb_cargo 
(id_cargo, ds_cargo, valor, fg_ativo)
VALUES 
(1,'Analista de sistema', 42000.00,1),
(2,'Adminstrador de BD', 7900.00,1),
(3, 'Desenvolvedor C#', 5740.00,1);



SELECT*
from tb_cargo;
-- AULA 5 ------------------------------------------------------
SELECT ds_cargo AS 'Descrição de cargo',
valor * 2 AS 'DObro saário'
FROM tb_cargo;

SELECT 3.78 * (12-3/0.43) AS
'Resultado da expressão';

SELECT tb_funcionario.nome,
tb_cargo.ds_cargo
FROM tb_funcionario,tb_cargo  
WHERE tb_funcionario.id_cargo = 
tb_cargo.id_cargo;

SELECT fc.nome, cg.ds_cargo
FROM tb_funcionario AS fc
JOIN tb_cargo AS cg ON fc.id_cargo = cg.id_cargo;

SELECT f.nome, c.valor
FROM tb_funcionario AS f
JOIN tb_cargo AS c ON(f.id_cargo = c.id_cargo)
WHERE c.valor = (SELECT MAX(c.valor)
                 FROM tb_funcionario AS f
                 JOIN tb_cargo AS c
                 ON(f.id_cargo = c.id_cargo));
                 
SELECT f.nome, c.valor
FROM tb_funcionario AS f
JOIN tb_cargo AS c ON(f.id_cargo = c.id_cargo)
WHERE c.valor > (SELECT AVG(valor) FROM tb_cargo);

SELECT id_funcionario, nome 
FROM tb_funcionario AS externa
WHERE EXISTS (SELECT id_funcionario
		      FROM tb_funcionario AS interna
              WHERE interna.id_gerente
			  =externa.id_funcionario);
              
SELECT id_funcionario, nome 
FROM tb_funcionario AS externa
WHERE NOT EXISTS (SELECT id_funcionario
		      FROM tb_funcionario AS interna
              WHERE interna.id_gerente
			  =externa.id_funcionario);              
              
SELECT f.id_cargo, AVG(c.valor)
FROM tb_funcionario AS f
JOIN tb_cargo AS c ON(f.id_cargo = c.id_cargo)
GROUP BY f.id_cargo;  

SELECT c.ds_cargo AS CARGO,
	COUNT(c.valor) AS FUNCIONÁRIOS,
	SUM(c.valor) AS SOMA
FROM tb_funcionario AS f
	JOIN tb_cargo AS c ON(f.id_cargo = c.id_cargo)
GROUP BY f.id_cargo;
              
              

                


-- ---------------------------------------------------------------

CREATE TABLE tb_escolaridade (
id_escolaridade	integer,
ds_escolaridade	varchar(60) NOT NULL,
fg_ativo		integer,
PRIMARY KEY (id_escolaridade));
-- ---------------------------------------------------------------



CREATE TABLE tb_funcionario(
id_funcionario	integer,
nome			varchar(40),
cpf				varchar(15),
rg 				varchar(15),
dt_adm			timestamp,
id_gerente		integer,
id_cargo		integer,
id_escolaridade	integer,
fg_ativo		integer,
PRIMARY KEY (id_funcionario),
FOREIGN KEY (id_gerente) REFERENCES tb_funcionario (id_funcionario),
FOREIGN KEY (id_cargo) REFERENCES tb_cargo (id_cargo),
FOREIGN KEY (id_escolaridade) REFERENCES tb_escolaridade (id_escolaridade));

-- Inserindo valores
INSERT INTO tb_funcionario
(id_funcionario, nome, cpf, rg, dt_adm, id_gerente,
id_cargo, id_escolaridade, fg_ativo)
VALUES 
(1, 'João Roberto da Silva', '12332145699',
'122344320', '2001-05-31', null, 1, 2, 1),
(2,'Miguel dos Santos', '87612354677',
'876523333', '2003-12-01', null, 1, 2, 1),
(3, 'Maria Dos Santos', '34576512344',
'765465230', '2004-02-28', null, 2, 2,1);

INSERT INTO tb_funcionario
(id_funcionario, nome, cpf, rg, dt_adm, id_gerente,
id_cargo, id_escolaridade, fg_ativo)
VALUES 
(4, 'Brennus Caio', '12332145688',
'1222344325', '2006-07-25', null, 2, 2, 1);

-- Comando de vizualização e seleção
SELECT*
FROM tb_funcionario;

SElECT nome
FROM tb_funcionario
WHERE id_cargo IN (2,3);

SELECT nome, cpf, rg
FROM tb_funcionario
WHERE dt_adm 
	BETWEEN '2000-01-01'AND '2005-12-31';

SELECT id_funcionario, nome, dt_adm
FROM tb_funcionario
ORDER BY 1;

SELECT* 
FROM tb_funcionario
WHERE id_funcionario=1;

SELECT DISTINCT (id_funcionario)
FROM tb_funcionario;

SELECT id_cargo, ds_cargo, valor 
FROM tb_cargo
WHERE valor > 4500 AND valor < 6000;



DELETE 
FROM tb_funcionario
WHERE id_funcionario=1;


UPDATE tb_funcionario 
SET nome = 'Kevyn Bi'
WHERE id_funcionario = 1;

-- Caculos Matematicos

SELECT 13*2, 75/3-1;

SELECT DATE ('2012-07-25') + 2;

SELECT count(id_funcionario)
FROM tb_funcionario;

SELECT MAX(valor), MIN(valor)
FROM tb_cargo;
